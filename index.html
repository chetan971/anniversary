<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated Effects Demo</title>

    <style>
        /* 1. Reset and Canvas Background */
        body {
            overflow: hidden; /* Prevent scrollbars */
            margin: 0;
            background-color: #000; /* Dark background for fireworks */
        }
        
        /* The canvas element must be sized correctly */
        #fireworks {
            display: block;
            position: fixed; /* Ensures it covers the whole screen */
            top: 0;
            left: 0;
            z-index: 1; /* Below the hearts */
        }

        /* 2. Heart Trail Styling (CSS for Attractiveness) */
        .heart {
            position: absolute; /* Essential for placing hearts at cursor/touch coordinates */
            font-size: 24px;   /* Size of the emoji */
            pointer-events: none; /* Crucial: Allows interacting with elements *under* the heart */
            user-select: none;  /* Prevent selecting the emoji */
            z-index: 9999;     /* Ensure the heart is on top of everything */

            /* Animation properties */
            transform: translate(-50%, -50%); /* Centers the heart on the cursor tip */
            animation: 
                fadeout 1.2s ease-out forwards, /* Fades out over 1.2s */
                liftup 1.2s ease-out forwards;  /* Moves upward over 1.2s */
        }

        /* 3. Keyframe Animations */
        @keyframes liftup {
            0% { transform: translate(-50%, -50%); opacity: 1; }
            100% { transform: translate(-50%, -150%); opacity: 0; }
        }

        @keyframes fadeout {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>

    <canvas id="fireworks"></canvas>

    <script>
        /************* HEART TRAIL *************/
        // Event listener for mobile touch movement
        document.addEventListener("touchmove", (e)=>{
            // Use the coordinates of the first touch point
            makeHeart(e.touches[0].clientX, e.touches[0].clientY);
            // Prevents the browser from scrolling while touching
            e.preventDefault(); 
        }, { passive: false }); // passive: false is sometimes needed for preventDefault

        // Event listener for desktop mouse movement
        document.addEventListener("mousemove", (e)=>{
            makeHeart(e.clientX, e.clientY);
        });

        function makeHeart(x, y) {
            const h = document.createElement("div");
            h.classList.add("heart");
            h.innerHTML = "ðŸ’—";
            // Use CSS positioning
            h.style.left = x + "px";
            h.style.top = y + "px";
            document.body.appendChild(h);
            // Remove the heart after the animation time (1200ms)
            setTimeout(()=>h.remove(), 1200);
        }

        /************* FIREWORKS (SOFT) *************/
        const canvas = document.getElementById("fireworks");
        const ctx = canvas.getContext("2d");
        let particles = [];
        
        // Function to adjust canvas size on screen resize (important for mobile)
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        // Initial size setting
        resizeCanvas(); 

        function startFireworks() {
            // Start a new firework explosion every 700ms
            setInterval(() => {
                const x = Math.random() * canvas.width;
                // Restrict y to the top half of the screen
                const y = Math.random() * canvas.height * 0.5; 
                createFirework(x, y);
            }, 700);
        }

        function createFirework(x, y) {
            for (let i = 0; i < 20; i++) {
                particles.push({
                    x, y,
                    // Random HSL color for vibrant fireworks
                    color: `hsl(${Math.random()*360},90%,65%)`, 
                    size: 2 + Math.random(),
                    // Random velocity for scattering
                    vx: (Math.random() - 0.5) * 3, 
                    vy: (Math.random() - 0.5) * 3
                });
            }
        }

        function animate() {
            // Clear the canvas on each frame
            ctx.clearRect(0,0,canvas.width,canvas.height); 
            
            // Iterate backwards for safe array removal
            for(let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                
                // Update properties
                p.x += p.vx;
                p.y += p.vy;
                p.size *= 0.96; // Shrink over time

                // Draw the particle
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
                ctx.fill();

                // Remove particle if it's too small
                if(p.size < 0.4) {
                    particles.splice(i,1);
                }
            }
            // Request the next frame
            requestAnimationFrame(animate); 
        }

        // --- Execution ---
        // 1. Start the animation loop
        animate(); 
        
        // 2. Start the fireworks generation interval
        startFireworks();

    </script>
</body>
</html>
